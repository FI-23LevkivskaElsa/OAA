Завдання виконують Марія та Ельза :)

Варіант №3: Реляційна модель із підтримкою агрегації даних (числа)

Даний варіант передбачає, що, для спрощення реалізації, всі стовпці у створюваних таблицях мають числовий тип даних.

Перелік команд, які необхідно реалізувати:

1. CREATE table_name (column_name *[INDEXED] [, ...]); - створення таблиці table_name, що містить стовпці, визначення яких наведено в круглих дужках. Визначення стовпця складається щонайменше з його імені. Додаткова частина (*) передбачає, що у визначенні стовпця ще може бути присутнє опціональне ключове слово INDEXED, яке означає необхідність індексування даного стовпця. Якщо ключове слово INDEXED не наведено, індекс створювати не потрібно. В якості результату команда повинна повертати певне повідомлення для користувача, наприклад “Table table_name has been created”.


Приклади:

CREATE students (age, average_grade);

CREATE measurements (id INDEXED, height INDEXED, weight);


2. INSERT [INTO] table_name (N [, ...]); - додавання нового рядка з даними до таблиці table_name. Кількість розділених комою значень в круглих дужках повинна дорівнювати кількості стовпців у таблиці. Порядок значень повинен відповідати тому порядку стовпців, який використовувався при створенні таблиці командою CREATE. В якості результату команда повинна повертати певне повідомлення для користувача, наприклад “1 row has been inserted into table_name.”.


Приклади:

INSERT INTO measurements (1, 180, 75);

INSERT measurements (2, 175, 72);.


3. Формування вибірки із таблиці table_name:

SELECT [agg_function(agg_column) [, ... ]] 

  FROM table_name
  
  [WHERE condition]
  
  [GROUP_BY column_name [, ...] ];
  
	Якщо в команді не використовується умова GROUP_BY, то після ключового слова SELECT не повинно бути вказано нічого. В цьому випадку вибірка повинна включати всі стовпці таблиці, причому в порядку, в якому вони були згадані в команді CREATE при створенні таблиці.
 
Якщо в команді вказана умова GROUP_BY gr_col_1, ..., gr_col_n, то це означає необхідність логічного групування рядків для подальшої агрегації даних в рамках сформованих груп і формування результуючої вибірки. В одну логічну групу потрапляють рядки, що мають однакові значення стовпців gr_col_1, gr_col_2, ..., gr_col_n, незалежно від значень інших стовпців. В такому випадку, після SELECT може бути вказано перелік агрегуючих функцій, які необхідно застосувати до стовпців таблиці в межах утворених логічних груп: agg_fun_1(agg_col_1), ..., agg_fun_k(agg_col_k). Кожна агрегуюча функція може бути використана довільну кількість разів із довільними стовпцями таблиці. У фінальній вибірці кожна логічна група представляється рівно 1 рядком, який складається із:

- gr_col_1, gr_col_2, ..., gr_col_n - стовпців, вказаних після ключового слова GROUP_BY, в точно такому ж порядку.

- Результату застосування агрегуючих функцій agg_fun_1, …, agg_fun_k до стовпців agg_col_1, …, agg_col_1 відповідно, якщо вони вказані після ключового слова SELECT. 

Перелік агрегуючих функцій, які потрібно підтримати:

- COUNT(column) - кількість значень в групі, незалежно від того, до якого стовпця застосовується.

- MAX(column) - максимальне значення стовпця column в межах групи.

- AVG(column) - середнє значення стовпця column в межах групи.

Якщо вказано ключове слово WHERE та слідуюча за ним умова, то команда повинна включити до вибірки (або брати для групування, якщо вказана умова GROUP_BY) тільки рядки, які задовольняють дану умову. В іншому випадку, необхідно включити всі рядки із таблиці. Умова condition має наступну структуру: 

	condition := column_name_1 = (column_name_2 | N).
 
Тобто умова складається із однієї бінарної операції порівняння =, зліва від якої повинен бути вказаний стовпець таблиці (column_name_1), а справа може бути або інший стовпець таблиці (column_name_2) або константа, задана у вигляді літералу безпосередньо у команді (N).

	Якщо в команді використовуються і WHERE, і GROUP_BY, то вони повинні йти саме в такому порядку (WHERE перед GROUP_BY).
 
	В якості результату команда повинна повертати сформовану вибірку, відформатовану у вигляді таблички, в якій порядок стовпців відповідає описаним вище умовам, а порядок рядків може бути довільним.


Приклади команд:

SELECT FROM measurements;

SELECT FROM measurements WHERE id = 1;


SELECT COUNT(id), AVG(weight)

  FROM measurements
  
  GROUP_BY height;


SELECT COUNT(id)

  FROM measurements
  
  WHERE height = 170
  
  GROUP_BY weight;


Приклад форматування таблиці:

+--------+-----------+-------------+

| height | COUNT(id) | AVG(weight) |

+--------+-----------+-------------+

|  180   |     1     |      75     |

|  175   |     1     |      72     |

+--------+-----------+-------------+
